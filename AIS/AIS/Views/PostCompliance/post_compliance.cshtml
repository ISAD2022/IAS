@{
    ViewData["Title"] = "Post Compliance";
    Layout = "_Layout";
}
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>

    <style type="text/css">
        .square-image {
            width: 270px; /* Set the desired width */
            height: 270px; /* Set the desired height */
            padding: 2px;
            border: 1px solid;
            object-fit: cover; /* Ensure the image covers the container */
        }

        .gallery {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: center;
            gap: 10px; /* Adjust the gap between images */
        }
    </style>
</head>
<script type="text/javascript">
    var g_newParaId = 0;
    var g_oldParaId = 0;
    var g_prevRole = "";
    var g_nextRole = "";
    var g_obsList = [];
    var g_allAttachedImages = [];


    var btnClick = "own";

    $(document).ready(function () {
        getOwnParasForCompliance();
        $('#viewMemo_compliance').richText({
            imageUpload: false,
            fileUpload: false,
            videoEmbed: false,
            urls: false
        });

        $("aks-file-upload").aksFileUpload({
            fileUpload: "#uploadfile", // With target [input]file or [type]json you can save the data of loaded items
            fileType: ["pdf", "docx", "rtf", "jpg", "jpeg", "png", "ppt", "doc", "pptx", "jpg", "zip", "csv"], // allowed file formats
            dragDrop: true, // drag & drop upload
            maxSize: "10 MB", // maximum uploaded file size
            multiple: true, // multiple file upload
            maxFile: 100, // maximum number of uploaded files
            maxFileError: "File exceeds upload limit. - Max limit:", // error text
            maxSizeError: "File exceeds size. - Max limit:", // error text
            fileTypeError: "Disallowed file format.", // error text
            label: "Drag & Drop your files or Browse" // label text

        });

        document.getElementById('aksfileupload').addEventListener('change', function () {
            
            var g_imgFiles = this.files;

            function readFileAsDataURL(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result.split(',')[1]); // get Base64 string without prefix
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            }

            async function processFiles(files) {
                const productImagesArr = [];
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    try {
                        const base64Data = await readFileAsDataURL(file);
                        var fileNameGen = generateUniqueTimestamp();
                        var extension = getFileExtension(file);
                        const ProductObject = {
                            'TEXT_ID': g_comId,
                            'IMAGE_NAME':file.name,
                            'FILE_NAME': fileNameGen + "." + extension,
                            'IMAGE_DATA': base64Data,
                            'IMAGE_TYPE': extension,
                            'LENGTH': file.size,
                            'SEQUENCE': i
                        };
                        productImagesArr.push(ProductObject);
                        g_allAttachedImages.push(ProductObject);
                    } catch (error) {

                    }
                }
                uploadFiles(productImagesArr);
            }

            function uploadFiles(productImagesArr) {
                $.ajax({
                    url: g_asiBaseURL + "/UploadFile/UploadFiles",
                    type: 'POST',
                    dataType: "json",
                    data: {
                        "files": productImagesArr
                    },
                    success: function (response) {

                        $.each($(".aks-file-upload .aks-file-upload-delete"), function (i, v) {
                            var filename=$(v).attr("data-delete");
                            for (var i = 0; i < g_allAttachedImages.length; i++){
                                if (g_allAttachedImages[i].IMAGE_NAME == filename){
                                    $(v).attr("file-name", g_allAttachedImages[i].FILE_NAME);
                                }
                            }
                        });
                        $(".aks-file-upload .aks-file-upload-delete").on("click", function (e) {
                            var filename = $(this).attr("file-name");
                            deleteFileFromServer(filename);
                        });

                    },
                    error: function (error) {

                    }
                });
            }


            processFiles(g_imgFiles);
        });

       
    });
    function getFileExtension(file) {
        var fileName = file.name;
        var extension = fileName.substring(fileName.lastIndexOf('.') + 1).toLowerCase();
        return extension;
    }
    function generateUniqueTimestamp() {
        var date = new Date();
        var year = date.getFullYear();
        var month = ('0' + (date.getMonth() + 1)).slice(-2);
        var day = ('0' + date.getDate()).slice(-2);
        var hours = ('0' + date.getHours()).slice(-2);
        var minutes = ('0' + date.getMinutes()).slice(-2);
        var seconds = ('0' + date.getSeconds()).slice(-2);
        var milliseconds = ('00' + date.getMilliseconds()).slice(-3);

        var timestamp = year + month + day + '_' + hours + minutes + seconds + milliseconds;
        return timestamp;
    }
    function deleteImageObjectByFileName(fileName) {
        const index = g_allAttachedImages.findIndex(image => image.FILE_NAME === fileName);
        if (index !== -1) {
            g_allAttachedImages.splice(index, 1);
        }
    }

    function deleteFileFromServer(fileName) {
        deleteImageObjectByFileName(fileName);
        $.ajax({
            url: g_asiBaseURL + "/UploadFile/DeleteFile",
            type: 'POST',
            data: { "fileName": fileName },
            dataType: 'json',
            success: function (response) {

            },
            error: function (error) {

            }
        });
    }
    function viewOwnCompliance() {
        btnClick = "own";
        $('#ownCompliance').addClass("btn-danger");
        $('#ownCompliance').removeClass("btn-outline-danger");

        $('#reviewCompliance').addClass("btn-outline-danger");
        $('#reviewCompliance').removeClass("btn-danger");


        $('#ownCompliancePanel').removeClass("d-none");
        $('#complianceReviewPanel').addClass("d-none");
        getOwnParasForCompliance();
    }
    function viewReviewCompliance() {
        btnClick = "review";
        $('#reviewCompliance').addClass("btn-danger");
        $('#reviewCompliance').removeClass("btn-outline-danger");


        $('#ownCompliance').addClass("btn-outline-danger");
        $('#ownCompliance').removeClass("btn-danger");

        $('#ownCompliancePanel').addClass("d-none");
        $('#complianceReviewPanel').removeClass("d-none");
        getReivewParasForCompliance();
    }
    function getOwnParasForCompliance() {

        $('#manageObsPanel tbody').empty();
        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/get_paras_for_compliance_by_auditee",
            type: "POST",
            data: {

            },
            cache: false,
            success: function (data) {
                g_obsList = data;
                var hidePrevCol = "";
                var hideNextCol = "";

                $('#entityNameField').html(data.length > 0 ? data[0].name : '');
                $.each(data, function (index, child) {

                    if (child.preV_ROLE == "N") {
                        child.preV_ROLE = "";
                        hidePrevCol = "d-none";
                    }

                    if (child.nexT_ROLE == "N") {
                        child.nexT_ROLE = "";
                        hideNextCol = "d-none";
                    }
                    if (child.receiveD_FROM == "N") {
                        child.receiveD_FROM = "";
                    }

                    $('#manageObsPanel tbody').append('<tr id="div_' + child.id + '"><td>' + ++index + '</td><td><p class="fw-normal mb-1">' + child.audiT_PERIOD + '</p></td><td><p class="fw-normal mb-1">' + child.parA_NO + '</p></td><td><p class="fw-normal mb-1">' + child.gisT_OF_PARAS + '</p></td><td><p class="fw-normal mb-1">' + child.receiveD_FROM + '</p></td><td>' + child.auditoR_REMARKS + '</td><td class="text-center"><a href="#" onclick="event.preventDefault();viewParaDetails(' + child.neW_PARA_ID + ',' + child.olD_PARA_ID + ',\'' + child.indicator + '\', \'' + child.parA_NO + '\', \'' + child.preV_ROLE + '\', \'' + child.nexT_ROLE + '\', \'' + child.coM_ID + '\'  );" class="text-hover text-danger mr-5px"><small>Compliance</small></a></td></tr>');


                });

            },

            dataType: "json",
        });

    }
    function getReivewParasForCompliance() {
        $('#manageObsPanel2 tbody').empty();
        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/get_paras_for_review_compliance_by_auditee",
            type: "POST",
            data: {

            },
            cache: false,
            success: function (data) {
                g_obsList = data;
                var hidePrevCol = "";
                var hideNextCol = "";

                $('#entityNameField').html(data.length > 0 ? data[0].name : '');
                $.each(data, function (index, child) {

                    if (child.preV_ROLE == "N") {
                        child.preV_ROLE = "";
                        hidePrevCol = "d-none";
                    }

                    if (child.nexT_ROLE == "N") {
                        child.nexT_ROLE = "";
                        hideNextCol = "d-none";
                    }
                    if (child.receiveD_FROM == "N") {
                        child.receiveD_FROM = "";
                    }

                    $('#manageObsPanel2 tbody').append('<tr id="div_' + child.id + '"><td>' + ++index + '</td><td><p class="fw-normal mb-1">' + child.audiT_PERIOD + '</p></td><td><p class="fw-normal mb-1">' + child.parA_NO + '</p></td><td><p class="fw-normal mb-1">' + child.gisT_OF_PARAS + '</p></td><td><p class="fw-normal mb-1">' + child.receiveD_FROM + '</p></td><td>' + child.auditoR_REMARKS + '</td><td class="text-center"><a href="#" onclick="event.preventDefault();viewParaDetails(' + child.neW_PARA_ID + ',' + child.olD_PARA_ID + ',\'' + child.indicator + '\', \'' + child.parA_NO + '\', \'' + child.preV_ROLE + '\', \'' + child.nexT_ROLE + '\', \'' + child.coM_ID + '\');" class="text-hover text-danger mr-5px"><small>Compliance</small></a></td></tr>');

                });

            },

            dataType: "json",
        });

    }
    function viewParaDetails(newParaId = 0, oldParaId = 0, indicator = '', memo_no = '', prevRole, nextRole, comID) {

        g_newParaId = newParaId;
        g_oldParaId = oldParaId;
        g_prevRole = prevRole;
        g_nextRole = nextRole;
        g_comId = comID;
        g_indicator = indicator;
        g_memoNo = memo_no;

        $('#viewParaComplianceModel').modal('show');
        $('#manageComplianceHistPanel tbody').empty();

        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/get_compliance_history",
            type: "POST",
            data: {
                'COM_ID': comID,
            },
            cache: false,
            success: function (data) {
                if (data.length == 0 && btnClick== "own") {
            $('#manageComplianceHistPanel tbody').append('<tr><td class="text-center" colspan="6"><i>No previous compliance submitted yet</i></td><td><a onclick="event.preventDefault();getComplianceText(' + comID + ', 0);" href="#" class="text-danger">Submit Compliance</a></td></tr>');
                    
                }
                else if (data.length == 0 && btnClick == "review") {
                    $('#manageComplianceHistPanel tbody').append('<tr><td class="text-center" colspan="7"><i>No previous compliance submitted yet</i></td></tr>');

                }
                else {

                    var cycle_count = data.length > 0 ? parseInt(data[0].coM_CYCLE) - 1 : 0;
                    $.each(data, function (i, v) {
                        if (v.coM_CYCLE > cycle_count) {
                            $('#manageComplianceHistPanel tbody').append('<tr><td><div>' + v.coM_CYCLE + '</div></td><td>' + v.pP_NO + '</td><td>' + v.name + '</td><td>' + v.designation + '</td><td>' + v.commenT_BY_ROLE + '</td><td>' + v.comments + '</td><td><a onclick="event.preventDefault();getComplianceText(' + v.coM_ID + ',' + v.coM_CYCLE + ');" href="#" class="text-danger">View Compliance</a></td></tr>');
                            cycle_count++;
                        }
                        else
                            $('#manageComplianceHistPanel tbody').append('<tr><td></td><td><div>' + v.pP_NO + '</div></td><td><div>' + v.name + '</div></td><td>' + v.designation + '</td><td>' + v.commenT_BY_ROLE + '</td><td>' + v.comments + '</td><td></td></tr>');

                    });
                }

            },

            dataType: "json",
        });

        /* $.ajax({
             url: g_asiBaseURL + "/ApiCalls/get_para_compliance_text",
             type: "POST",
             data: {
                 'NEW_PARA_ID': newParaId,
                 'OLD_PARA_ID': oldParaId,
                 'INDICATOR': indicator
             },
             cache: false,
             success: function (data) {

                 if (prevRole == "") {
                     $('#viewMemoModel').modal('show');
                     $('#viewMemo_memoNumber').val(memo_no);
                     $('#viewMemo_paraGist').val(data.gisT_OF_PARA);
                     $('#viewMemo_memo').html(data.parA_TEXT);
                     $('#viewMemo_compliance').val('').trigger('change');
                     if (prevRole == "")
                         $('#prevRoleButtonHandler').remove();
                     else
                         $('#prevRoleButtonHandler').html(prevRole);

                     if (nextRole == "")
                         $('#nextRoleButtonHandler').remove();
                     else
                         $('#nextRoleButtonHandler').html(nextRole);

                     $('#listofRespPersons tbody').empty();
                     if (data.responsiblE_PPs.length > 0) {
                         $.each(data.responsiblE_PPs, function (j, pp) {
                             var srNo = $('#listofRespPersons tbody tr').length;
                             srNo++;
                             $('#listofRespPersons tbody').append('<tr id="tr_' + pp.pP_NO + '"><td>' + srNo + '</td><td>' + pp.pP_NO + '</td><td>' + pp.emP_NAME + '</td><td>' + pp.loaN_CASE + '</td><td>' + pp.lC_AMOUNT + '</td><td>' + pp.accounT_NUMBER + '</td><td>' + pp.acC_AMOUNT + '</td></tr>');
                         });
                     }

                 } else {
                     $('#viewMemoReportingModel').modal('show');
                     $('#viewMemo_memoNumber_rep').val(memo_no);
                     $('#viewMemo_paraGist_rep').val(data.gisT_OF_PARA);
                     $('#viewMemo_memo_rep').html(data.parA_TEXT);
                     $('#viewMemo_compliance_rep').val('');
                     if (prevRole == "")
                         $('#prevRoleButtonHandler_rep').remove();
                     else
                         $('#prevRoleButtonHandler_rep').html(prevRole);

                     if (nextRole == "")
                         $('#nextRoleButtonHandler_rep').remove();
                     else
                         $('#nextRoleButtonHandler_rep').html(nextRole);

                     $('#listofRespPersons_rep tbody').empty();
                     if (data.responsiblE_PPs.length > 0) {
                         $.each(data.responsiblE_PPs, function (j, pp) {
                             var srNo = $('#listofRespPersons_rep tbody tr').length;
                             srNo++;
                             $('#listofRespPersons_rep tbody').append('<tr id="tr_' + pp.pP_NO + '"><td>' + srNo + '</td><td>' + pp.pP_NO + '</td><td>' + pp.emP_NAME + '</td><td>' + pp.loaN_CASE + '</td><td>' + pp.lC_AMOUNT + '</td><td>' + pp.accounT_NUMBER + '</td><td>' + pp.acC_AMOUNT + '</td></tr>');
                         });
                     }

                 }


             },

             dataType: "json",
         }); */
    }

   
    function PublishCompliance(ind) {

        var complianceRemarks = "";
        var commentsRemarks = "";
        var productImagesArr = [];

        if (g_prevRole == "") {
            if ($('.richText-editor').html() == "") {
                alert("Please provide Compliance to proceed");
                return;
            }


            complianceRemarks = $('.richText-editor').html();

        }
        else {
            if ($('#viewMemo_compliance_rep').val() == "") {
                alert("Please provide Remarks to proceed");
                return;
            }
            commentsRemarks = $('#viewMemo_compliance_rep').val();
        }


        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/submit_post_audit_compliance",
            type: "POST",
            data: {
                'OLD_PARA_ID': g_oldParaId,
                'NEW_PARA_ID': g_newParaId,
                'INDICATOR': ind,
                'COMPLIANCE': complianceRemarks,
                'COMMENTS': commentsRemarks,
                'EVIDENCE_LIST': g_allAttachedImages
            },
            cache: false,
            success: function (data) {
                alert(data.Message);
                onAlertCallback(reloadLocation);
            },
            dataType: "json",
        });
    }
    function reloadLocation() {

        $('#viewParaComplianceModel').modal('hide');
        $('#viewMemoModel').modal('hide');
        $('#viewMemoReportingModel').modal('hide');
        if (btnClick == "own")
            getOwnParasForCompliance();
        else
            getReivewParasForCompliance();
    }

    function getComplianceText(comID, cycle) {

        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/get_para_compliance_text",
            type: "POST",
            data: {
                'NEW_PARA_ID': g_newParaId,
                'OLD_PARA_ID': g_oldParaId,
                'INDICATOR': g_indicator
            },
            cache: false,
            success: function (data) {

                if (g_prevRole == "") {
                    $('#viewMemoModel').modal('show');
                    $('#viewMemo_memoNumber').val(g_memoNo);
                    $('#viewMemo_paraGist').val(data.gisT_OF_PARA);
                    $('#viewMemo_memo').html(data.parA_TEXT);
                    $('#viewMemo_compliance').val('').trigger('change');
                    if (g_prevRole == "")
                        $('#prevRoleButtonHandler').remove();
                    else
                        $('#prevRoleButtonHandler').html(g_prevRole);

                    if (g_nextRole == "")
                        $('#nextRoleButtonHandler').remove();
                    else
                        $('#nextRoleButtonHandler').html(g_nextRole);

                    $('#listofRespPersons tbody').empty();
                    if (data.responsiblE_PPs.length > 0) {
                        $.each(data.responsiblE_PPs, function (j, pp) {
                            var srNo = $('#listofRespPersons tbody tr').length;
                            srNo++;
                            $('#listofRespPersons tbody').append('<tr id="tr_' + pp.pP_NO + '"><td>' + srNo + '</td><td>' + pp.pP_NO + '</td><td>' + pp.emP_NAME + '</td><td>' + pp.loaN_CASE + '</td><td>' + pp.lC_AMOUNT + '</td><td>' + pp.accounT_NUMBER + '</td><td>' + pp.acC_AMOUNT + '</td></tr>');
                        });
                    }

                    $.ajax({
                        url: g_asiBaseURL + "/ApiCalls/get_old_para_compliance_cycle_text",
                        type: "POST",
                        data: {
                            'COM_ID': comID,
                            'C_CYCLE': cycle
                        },
                        cache: false,
                        success: function (data) {
                            $('#complianceCycleTextPanel').html(data.parA_TEXT);
                            $('#complianceCycleEvidences').empty();
                            if (data.evidences && data.evidences.length > 0) {

                                $.each(data.evidences, function (j, pp) {
                                    $('#complianceCycleEvidences').append('<a href="data:image/png; base64, ' + pp.imagE_DATA + '" data-lightbox="gallery"><img class="square-image" src="data:image/png; base64, ' + pp.imagE_DATA + '" alt="Image 1"></a> ');
                                });
                            } else {
                                $('#complianceCycleEvidences').append("<i>No evidence is attached </i>");
                            }

                            lightbox.option({
                                'resizeDuration': 200,
                                'wrapAround': true
                            });
                        },

                        dataType: "json",
                    });

                } else {
                    $('#viewMemoReportingModel').modal('show');
                    $('#viewMemo_memoNumber_rep').val(g_memoNo);
                    $('#viewMemo_paraGist_rep').val(data.gisT_OF_PARA);
                    $('#viewMemo_memo_rep').html(data.parA_TEXT);
                    $('#viewMemo_compliance_rep').val('');
                    if (g_prevRole == "")
                        $('#prevRoleButtonHandler_rep').remove();
                    else
                        $('#prevRoleButtonHandler_rep').html(g_prevRole);

                    if (g_nextRole == "")
                        $('#nextRoleButtonHandler_rep').remove();
                    else
                        $('#nextRoleButtonHandler_rep').html(g_nextRole);

                    $('#listofRespPersons_rep tbody').empty();
                    if (data.responsiblE_PPs.length > 0) {
                        $.each(data.responsiblE_PPs, function (j, pp) {
                            var srNo = $('#listofRespPersons_rep tbody tr').length;
                            srNo++;
                            $('#listofRespPersons_rep tbody').append('<tr id="tr_' + pp.pP_NO + '"><td>' + srNo + '</td><td>' + pp.pP_NO + '</td><td>' + pp.emP_NAME + '</td><td>' + pp.loaN_CASE + '</td><td>' + pp.lC_AMOUNT + '</td><td>' + pp.accounT_NUMBER + '</td><td>' + pp.acC_AMOUNT + '</td></tr>');
                        });
                    }

                    $.ajax({
                        url: g_asiBaseURL + "/ApiCalls/get_old_para_compliance_cycle_text",
                        type: "POST",
                        data: {
                            'COM_ID': comID,
                            'C_CYCLE': cycle
                        },
                        cache: false,
                        success: function (data) {
                            $('#complianceCycleTextPanel_rep').html(data.parA_TEXT);
                            $('#complianceCycleEvidences_rep').empty();
                            if (data.evidences.length > 0) {

                                $.each(data.evidences, function (j, pp) {
                                    $('#complianceCycleEvidences_rep').append('<a href="data:image/png; base64, ' + pp.imagE_DATA + '" data-lightbox="gallery"><img class="square-image" src="data:image/png; base64, ' + pp.imagE_DATA + '" alt="Image 1"></a> ');
                                });
                            } else {
                                $('#complianceCycleEvidences_rep').append("<i>No evidence is attached </i>");
                            }

                            lightbox.option({
                                'resizeDuration': 200,
                                'wrapAround': true
                            });
                        },

                        dataType: "json",
                    });
                }
            },

            dataType: "json",
        });



    }
</script>


<div class="row">
    <div class="row col-md-12 mt-3">
        <div class="col-md-6">
            <button onclick="viewOwnCompliance();" id="ownCompliance" class="btn btn-danger w-100">@ViewData["UserEntityName"] COMPLIANCE</button>
        </div>
        <div class="col-md-6">
            <button onclick="viewReviewCompliance();" id="reviewCompliance" class="btn btn-outline-danger btn-default w-100">COMPLIANCE FOR REVIEW</button>
        </div>

    </div>


    <div id="ownCompliancePanel" class="row col-md-12 mt-3">
        <h3 style=" display:block;color: #45c545;">LIST OF OUTSTANADING @ViewData["UserEntityName"] COMPLIANCES </h3>
        <table id="manageObsPanel" class="table table-hover table-bordered table-hover mt-3 table-striped">
            <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                <tr>
                    <th class="col-md-auto">Sr No.</th>
                    <th class="col-md-auto">Audit Year</th>
                    <th class="col-md-auto">Para No.</th>
                    <th class="col-md-auto">Title / Gist</th>
                    <th class="col-md-auto">Receive From</th>
                    <th class="col-md-auto">Auditor Remarks</th>
                    <th class="col-md-auto">Compliance History</th>
                </tr>
            </thead>
            <tbody></tbody>

        </table>
    </div>


    <div id="complianceReviewPanel" class="row col-md-12 d-none mt-3">
        <h3 style=" display:block;color: #45c545;">LIST OF OUTSTANDING COMPLIANCES FOR REVIEW</h3>
        <table id="manageObsPanel2" class="table table-hover table-bordered table-hover mt-3 table-striped">
            <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                <tr>
                    <th class="col-md-auto">Sr No.</th>
                    <th class="col-md-auto">Audit Year</th>
                    <th class="col-md-auto">Para No.</th>
                    <th class="col-md-auto">Title / Gist</th>
                    <th class="col-md-auto">Receive From</th>
                    <th class="col-md-auto">Auditor Remarks</th>
                    <th class="col-md-auto">Compliance History</th>
                </tr>
            </thead>
            <tbody></tbody>

        </table>
    </div>

</div>

<div id="viewParaComplianceModel" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl" role="document" style="min-width:95% !important;">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Compliance History</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>

                    <div class="row col-md-12 mt-3">
                        <table id="manageComplianceHistPanel" class="table table-hover table-bordered table-hover mt-3 table-striped">
                            <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                                <tr>
                                    <th class="col-md-auto">Compliance Cycle</th>
                                    <th class="col-md-auto">PP Number</th>
                                    <th class="col-md-auto">Designation</th>
                                    <th class="col-md-auto">Name</th>
                                    <th class="col-md-auto">Remarks Role</th>
                                    <th class="col-md-auto">Remarks</th>
                                    <th class="col-md-auto">View Compliance</th>
                                </tr>
                            </thead>
                            <tbody></tbody>

                        </table>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div id="viewMemoModel" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Observation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="viewMemo_memoNumber">Memo Number</label>
                        <input id="viewMemo_memoNumber" class="form-control" disabled="disabled" />
                    </div>
                    <div class="form-group">
                        <label for="viewMemo_memoNumber">Gist of Para</label>
                        <input id="viewMemo_paraGist" class="form-control" disabled="disabled" />
                    </div>
                    <div class="form-group">
                        <label for="viewMemo_memo">Para</label>
                        <div id="viewMemo_memo" disabled="disabled" style="height: auto; overflow-y: auto;" class="form-control"></div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="viewMemo_respPP" class="font-weight-bold">Responsible Personals</label>
                        <div class="col-md-12 pl-0 pr-0">
                            <table id="listofRespPersons" class="table table-hover table-bordered table-hover mt-3 table-striped">
                                <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                                    <tr>
                                        <th class="col-md- auto font-weight-bold">Sr.No</th>
                                        <th class="col-md- auto font-weight-bold">P.P. No</th>
                                        <th class="col-md- auto font-weight-bold">Name</th>
                                        <th class="col-md- auto font-weight-bold">Loan Case</th>
                                        <th class="col-md- auto font-weight-bold">LC Amount</th>
                                        <th class="col-md- auto font-weight-bold">Account No.</th>
                                        <th class="col-md- auto font-weight-bold">ACC Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <label class="font-weight-bold">Compliance Text</label>
                        <div class="row col-md-12 mt-3 mb-3">
                            <div id="complianceCycleTextPanel" class="col-md-12"></div>
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label class="font-weight-bold">Evidences</label>
                        <div class="row col-md-12 mt-3 mb-3">
                            <div id="complianceCycleEvidences" class="gallery" style="display:inline-flex">
                            </div>
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <label for="viewMemo_compliance">Compliance /Remarks</label>
                        <textarea class="form-control" id="viewMemo_compliance"></textarea>
                    </div>

                    <div id="evidenceUploader" class="input-field">
                        <label class="active">Evidences</label>
                        <aks-file-upload></aks-file-upload>
                    </div>



                </form>
            </div>
            <div class="modal-footer">
                <button id="prevRoleButtonHandler" onclick="PublishCompliance('D')" type="button" class="btn btn-danger"></button>
                <button id="nextRoleButtonHandler" onclick="PublishCompliance('U')" type="button" class="btn btn-success"></button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div id="viewMemoReportingModel" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Observation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="viewMemo_memoNumber">Memo Number</label>
                        <input id="viewMemo_memoNumber_rep" class="form-control" disabled="disabled" />
                    </div>
                    <div class="form-group">
                        <label for="viewMemo_memoNumber">Gist of Para</label>
                        <input id="viewMemo_paraGist_rep" class="form-control" disabled="disabled" />
                    </div>
                    <div class="form-group">
                        <label for="viewMemo_memo">Para</label>
                        <div id="viewMemo_memo_rep" disabled="disabled" style="height: auto; overflow-y: auto;" class="form-control"></div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="viewMemo_respPP_rep" class="font-weight-bold">Responsible Personals</label>
                        <div class="col-md-12 pl-0 pr-0">
                            <table id="listofRespPersons" class="table table-hover table-bordered table-hover mt-3 table-striped">
                                <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                                    <tr>
                                        <th class="col-md- auto font-weight-bold">Sr.No</th>
                                        <th class="col-md- auto font-weight-bold">P.P. No</th>
                                        <th class="col-md- auto font-weight-bold">Name</th>
                                        <th class="col-md- auto font-weight-bold">Loan Case</th>
                                        <th class="col-md- auto font-weight-bold">LC Amount</th>
                                        <th class="col-md- auto font-weight-bold">Account No.</th>
                                        <th class="col-md- auto font-weight-bold">ACC Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>


                    <div class="form-group mt-3">
                        <label>Compliance Text</label>
                        <div class="row col-md-12 mt-3 mb-3">
                            <div id="complianceCycleTextPanel_rep" class="col-md-12"></div>
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label>Evidences</label>
                        <div class="row col-md-12 mt-3 mb-3">
                            <div id="complianceCycleEvidences_rep" class="gallery" style="display:inline-flex">
                            </div>
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label for="viewMemo_compliance">Compliance/Remarks</label>
                        <textarea class="form-control" id="viewMemo_compliance_rep"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="prevRoleButtonHandler_rep" onclick="PublishCompliance('D')" type="button" class="btn btn-danger"></button>
                <button id="nextRoleButtonHandler_rep" onclick="PublishCompliance('U')" type="button" class="btn btn-success"></button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
