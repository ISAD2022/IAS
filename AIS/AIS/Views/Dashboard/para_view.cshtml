@{
    ViewData["Title"] = "Functional Para View";
    Layout = "_Layout";
}

<script>



    function getObservations() {

        $('#entitywise_panel tbody').empty();
        if ($('#OptionBox').val() == 0)
            return;

        $.ajax({
            url: "/ApiCalls/get_functional_observations",
            type: "POST",
            data: {
                'PROCESS_ID': $('#OptionBox').val()
            },
            cache: false,
            success: function (data) {
                var sr = 1;

                $.each(data, function (index, item) {


                    $('#entitywise_panel tbody').append("<tr><td>" + sr + "</td><td>" + item.name + "</td><td>" + item.audiT_PERIOD + "</td> <td class=\"text-right\">" + item.parA_NO + "</td><td><a href=\"#\" onclick=\"getParaText(" + item.id + ", '"+item.parA_CATEGORY+"');\">View Para Text</a></td></tr>");
                    sr++;
                });


            },
            dataType: "json",
        });
    }

    function getParaText(id, pc) {
        $('#paraTextViewerModel').modal("show");
        $('#paraTextDivField').empty();

        $.ajax({
            url: "/ApiCalls/get_functional_observation_text",
            type: "POST",
            data: {
                'PARA_ID': id,
                'PARA_CATEGORY': pc
            },
            cache: false,
            success: function (data) {
                $('#paraTextDivField').html(data);
            }
        });
    }

</script>
<div class="row col-md-12">
    <h3 style="color: rgb(186 113 46) !important;">Functional Responsibility for Policy/Procedure Improvement and Control Implementation</h3>
</div>


<div class="row col-md-12 mt-3">
    <div class="col-md-12">
        <label class="text-bold"><b>Annexure</b></label>
    </div>
    <div class="col-md-12 mt-1">
        <select onchange="getObservations();" id="OptionBox" class="form-control">
            <option value="0">--Select Annexure--</option>
            @{
                if (ViewData["OptionList"] != null)
                {
                    foreach (var item in (dynamic)(ViewData["OptionList"]))
                    {
                        <option value="@item.ID">@item.HEADING</option>

                    }
                }
            }

        </select>
    </div>
</div>
<div class="row col-md-12">
    <div class="mt-3 col-md-12">
        <table id="entitywise_panel" class="table table-hover table-bordered table-hover mt-3 table-striped">
            <thead style="background-color: #FF5722 !important; ">
                <tr>
                    <th class="col-md-auto text-light">Sr. No.</th>
                    <th class="col-md-auto text-light">Entity Name</th>
                    <th class="col-md-auto text-center text-light">Audit Period</th>
                    <th class="col-md-auto text-center text-light">Para No</th>
                    <th class="col-md-auto text-center text-light"></th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>

<div id="paraTextViewerModel" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog  modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Para Text</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="mt-3 modal-body">
                <form>
                    <div class="row mt-3 col-md-12">
                        <div id="paraTextDivField" style="max-width:100%; overflow-y:auto;" class="col-md-12"></div>

                    </div>


                </form>
            </div>

            <div class="mt-3 modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>